
SELECT I.ITEM_ID,I.ITEM_NAME,I.RARITY
FROM ITEM_INFO I
WHERE I.ITEM_ID IN (

    SELECT IT.ITEM_ID
    FROM ITEM_INFO II
    INNER JOIN ITEM_TREE IT
    ON II.ITEM_ID = IT.PARENT_ITEM_ID
    WHERE II.RARITY = "RARE" AND IT.PARENT_ITEM_ID IS NOT NULL
)
ORDER BY I.ITEM_ID DESC